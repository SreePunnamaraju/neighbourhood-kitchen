<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Neighbourhood Kitchen Mobile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {margin:0; font-family: Arial,sans-serif; background:#fcf9ec;}
    .sticky-nav{
      position:sticky;top:0;background:#fff;z-index:9;border-bottom:2px solid #e1c7a7;padding:15px 0 12px 0;
      display:flex;flex-wrap:nowrap;overflow-x:auto;justify-content:flex-start;
      scrollbar-width:thin;scrollbar-color:#d4b07a #fff;
    }
    .cat-btn{
      margin:13px 20px 13px 0;background:#a98567;color:#fff;border-radius:18px;border:none;padding:17px 25px;font-weight:500;font-size:1em;cursor:pointer;flex-shrink:0;transition:background 0.2s;
    }
    .cat-btn.active{background:#d4b07a;}
    h1{text-align:center;color:#765c3d;margin:28px 0 20px;}
    .items-list{max-width:540px;margin:0 auto 130px;max-height:56vh;overflow-y:auto;}
    .item-card{background:#fff;border-radius:7px;margin:28px 16px 18px 16px;padding:32px 16px;box-shadow:0 1px 8px #eee;display:flex;justify-content:space-between;align-items:center;}
    .veg{border-left:6px solid #7dda78;}
    .non-veg{border-left:6px solid #ffb2b2;}
    .egg{border-left:6px solid #ffe073;}
    .add-btn{background:#a98567;color:#fff;border:none;border-radius:7px;padding:17px 36px;font-weight:600;margin-left:30px;cursor:pointer;}
    .cart-bar{background:#fff7e6;position:fixed;left:0;right:0;bottom:0;padding:25px 23px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 -1px 9px #e7d5a9;z-index:10;}
    .cart-bar.hidden{display:none;}
    .cart-items-summary{font-weight:500;}
    .modal-bg{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.55);z-index:99;}
    .modal{background:#fff;max-width:470px;margin:13vh auto 0;padding:60px 48px 61px 48px;border-radius:13px;box-shadow:0 3px 28px #cfa9693b;}
    .modal-title{font-weight:bold;font-size:1.17em;margin-bottom:29px;}
    .order-list{margin:33px 0 55px 0;font-size:1.18em;line-height:2.2;}
    .modal-form{margin-top:37px;display:flex;flex-direction:column;}
    .modal-form input[type=text]{padding:20px;width:100%;margin-bottom:48px;margin-top:18px;border-radius:8px;border:1px solid #c7b49f;font-size:1.16em;}
    .modal-btn-row{display:flex;gap:26px;}
    .modal-btn{background:#b68f3b;color:#fff;border:none;border-radius:7px;padding:21px 41px;font-size:1.15em;font-weight:600;margin-bottom:0;cursor:pointer;}
    .modal-btn.secondary{background:#c6c6c6;color:#333;}
    @media(max-width:460px){
      .item-card{margin:20px 3px;}
      .modal{max-width:99vw;}
      .cart-bar{padding:16px;}
      .items-list{max-width:99vw;}
    }
    /* Custom scrollbar hide for sticky-nav, optional */
    .sticky-nav::-webkit-scrollbar {height:8px;}
    .sticky-nav::-webkit-scrollbar-thumb {background:#d4b07a;border-radius:5px;}
    .sticky-nav::-webkit-scrollbar-track {background:#fff;}
  </style>
</head>
<body>
<h1>The Neighbourhood Kitchen</h1>
<div class="sticky-nav" id="catNav"></div>
<div class="items-list" id="itemsList"></div>
<div class="cart-bar hidden" id="cartBar" onclick="showCartModal()">
  <span class="cart-items-summary" id="cartCount"></span>
  <span id="cartTotal"></span>
  <span style="margin-left:auto;background:#c09253;color:#fff;border-radius:8px;padding:15px 25px;font-weight:600;">Place Order</span>
</div>
<div class="modal-bg" id="cartModalBg">
  <div class="modal">
    <div class="modal-title">Your Order</div>
    <div class="order-list" id="orderSummary"></div>
    <form id="orderForm" class="modal-form" onsubmit="placeOrder(event)">
      <input id="tableName" type="text" required placeholder="Enter name/mobile number" />
      <div class="modal-btn-row">
        <button type="submit" class="modal-btn">Place Order</button>
        <button type="button" class="modal-btn secondary" onclick="hideCartModal()">Continue Selection</button>
      </div>
    </form>
  </div>
</div>
<script>
const menu = [
  // ... [same as your list above]
];
let cart = [];
let catList = Array.from(new Set(menu.map(i => i.category)));
const catNav = document.getElementById('catNav');
const itemsList = document.getElementById('itemsList');
catList.forEach(cat=>{
  let btn = document.createElement('button');
  btn.textContent = cat;
  btn.className = 'cat-btn';
  btn.onclick = ()=>filterCategory(cat);
  catNav.appendChild(btn);
});
function filterCategory(cat) {
  document.querySelectorAll('.cat-btn').forEach(btn=>btn.classList.remove('active'));
  Array.from(catNav.children).find(btn=>btn.textContent==cat).classList.add('active');
  showItems(cat);
  // Auto-scroll to the first item of this category
  setTimeout(()=>{
    let first = Array.from(itemsList.children)[0];
    if(first) first.scrollIntoView({behavior:'smooth',block:'start'});
  },20);
  // Scroll horizontally so the selected category is centered
  let activeBtn = Array.from(catNav.children).find(btn=>btn.textContent==cat);
  if(activeBtn){
    let left = activeBtn.offsetLeft - catNav.offsetWidth/2 + activeBtn.offsetWidth/2;
    catNav.scrollTo({left:left, behavior:'smooth'});
  }
}
function showItems(cat) {
  itemsList.innerHTML = '';
  menu.filter(i => !cat || i.category == cat).forEach((item, idx)=>{
    itemsList.innerHTML += `<div class="item-card ${item.type}" tabindex="0">
      <div>
        <div style="font-weight:600;margin-bottom:16px;">${item.name}</div>
        <small style="color:#84745A;">${item.category} • ₹${item.price} • ${item.type.charAt(0).toUpperCase() + item.type.slice(1)}</small>
      </div>
      <button class="add-btn" onclick="addToCart(${menu.findIndex(m=>m==item)});event.stopPropagation()">Add</button>
    </div>`;
  });
}
showItems();
function addToCart(idx) {
  let item = menu[idx];
  let found = cart.find(i=>i.name==item.name);
  if(found) found.qty++;
  else cart.push({...item, qty:1});
  updateCartBar();
}
function updateCartBar() {
  const count = cart.reduce((sum,i)=>sum+i.qty,0);
  const total = cart.reduce((sum,i)=>sum+i.qty*i.price,0);
  document.getElementById('cartCount').textContent = `Items: ${count}`;
  document.getElementById('cartTotal').textContent = `Total: ₹${total}`;
  document.getElementById('cartBar').classList.toggle('hidden', cart.length==0);
}
function showCartModal() {
  let summaryHtml = cart.length
    ? cart.map(i=>`<div>${i.name} x${i.qty} - ₹${i.qty*i.price}</div>`).join('') + `<div style="margin-top:24px;font-weight:600;">Total: ₹${cart.reduce((sum,i)=>sum+i.qty*i.price,0)}</div>`
    : "<em>No items yet!</em>";
  document.getElementById('orderSummary').innerHTML = summaryHtml;
  document.getElementById('cartModalBg').style.display='block';
}
function hideCartModal() {
  document.getElementById('cartModalBg').style.display='none';
}
function placeOrder(event) {
  event.preventDefault();
  const table = document.getElementById('tableName').value || "Online";
  const now = new Date();
  const orderDetails = {
    table: table,
    date: now.toLocaleDateString(),
    time: now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
    value: cart.reduce((sum, item) => sum + item.price * item.qty, 0),
    status: "Paid",
    order: cart.map(i=>`${i.name} x${i.qty}`).join(', ')
  };
  fetch('https://script.google.com/macros/s/AKfycbzEgDgE-8NeNudGa24a4BUQcnjylOVcdD0_v40fQDYeU9EmA8nr3Bu3vsI7EwMPvDnY/exec', {
    method: 'POST',
    body: JSON.stringify(orderDetails)
  })
  .then(r=>r.text())
  .then(msg=>{
    alert(msg || "Order placed!");
    cart = [];
    hideCartModal();
    updateCartBar();
    document.getElementById('tableName').value = '';
    document.querySelectorAll('.cat-btn').forEach(btn=>btn.classList.remove('active'));
    window.scrollTo({top:0,behavior:'smooth'});
    showItems();
  })
  .catch(err=>alert("Order failed: "+err));
}
updateCartBar();
</script>
</body>
</html>
